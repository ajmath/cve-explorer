fragment PageInfo on CvePageData {
  beforeIndex
  afterIndex
  limit
  query
}

fragment ReferenceInfo on Reference {
  url
  name
}

fragment PackageInfo on AffectedPackage {
  vendor
  product
  versions
}

fragment CveInfo on Cve {
  id
  description
  severity
  publishedOn
  affectedPackages {
    ...PackageInfo
  }
  references {
    ...ReferenceInfo
  }
}

query CveSearch($input: CveSearchInput = null) {
  cveSearch(input: $input) {
    results {
      ...CveInfo
    }
    prevPageInput {
      ...PageInfo
    }
    nextPageInput {
      ...PageInfo
    }
  }
}
